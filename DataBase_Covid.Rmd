---
title: "DataBase_Covid"
output: html_document
---

# 1 Cargar paquete
```{r}
# Cargar el paquete rentrez
# install.packages("rentrez")  # Descomenta si no está instalado
library(rentrez)
```

# 2 Buscar secuencias en NCBI
```{r}
# Búsqueda de secuencias del SARS-CoV-2 en la base de datos nucleotide
search_results <- entrez_search(
  db = "nucleotide",
  term = "SARS-CoV-2[Organism]",
  retmax = 10
)
```

# 3 Ver los IDs encontrados
```{r}
# Mostrar los IDs de secuencias encontrados
search_results$ids
```

# 4 Descargar una secuencia (puedes elegir otra distinta a la 1)
```{r}
# Obtener la secuencia correspondiente al segundo ID (por ejemplo)
sequence_id <- search_results$ids[2]
sequence_data <- entrez_fetch(
  db = "nucleotide",
  id = sequence_id,
  rettype = "fasta",
  retmode = "text"
)
```

# 5 Ver la secuencia en formato FASTA
```{r}
# Imprimir secuencia en formato FASTA
cat(sequence_data)
```

# 6 Limpiar la secuencia
```{r}
# Limpiar la secuencia para obtener solo A, T, C y G
sequence_clean <- gsub("[^ATCG]", "", sequence_data)
```

# 7  Mostrar la secuencia limpia
```{r}
# Mostrar la secuencia limpia
cat(sequence_clean)
```

# 8 Contar frecuencias de bases
```{r}
# Contar frecuencia de cada base
base_freq <- table(strsplit(sequence_clean, ""))
```

# 9 Mostrar la frecuencia
```{r}
# Imprimir frecuencia de bases
print(base_freq)
```


