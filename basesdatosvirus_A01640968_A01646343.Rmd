---
title: "basesdatosvirus_A01640968_A01646343"
output: html_document
---

```{r}
# Instalar packages
if (!require("Biostrings")) install.packages("BiocManager")
if (!require("reshape2", quietly = TRUE)) install.packages("reshape2")
library(reshape2)
if (!require("ggplot2", quietly = TRUE)) install.packages("ggplot2")
library(ggplot2)
if (!requireNamespace("BiocManager", quietly = TRUE)) install.packages("BiocManager")
BiocManager::install("Biostrings")

library(Biostrings)
```


```{r}
# ğŸ“ Ruta base donde estÃ¡n los archivos .fasta
ruta_base <- "/Users/alvarogonzalez/Documents/ITC/2_Semestre/2_Periodo/Computational-Biology-Analysis/Virus_DataBase"

# ğŸ§¾ Archivos FASTA con ruta completa
virus_files <- list(
  Zika = file.path(ruta_base, "zika.fasta"),
  SARS = file.path(ruta_base, "sars.fasta"),
  Wuhan = file.path(ruta_base, "wuhan.fasta"),
  MERS = file.path(ruta_base, "mers.fasta"),
  Dengue = file.path(ruta_base, "dengue1.fasta"),
  H1N1 = file.path(ruta_base, "h1n1_segment1.fasta")  # Reemplaza si tienes mÃ¡s segmentos
)

# ğŸ” FunciÃ³n para analizar cada secuencia
analizar_virus <- function(filepath) {
  secuencia <- readDNAStringSet(filepath)[[1]]
  
  tamano <- length(secuencia)
  composicion <- alphabetFrequency(secuencia, baseOnly = TRUE)
  gc_content <- sum(composicion[c("G", "C")]) / tamano * 100
  complementaria <- as.character(complement(secuencia))
  
  list(
    tamano = tamano,
    composicion = composicion,
    GC = round(gc_content, 2),
    complementaria = substr(complementaria, 1, 60)  # Mostrar solo los primeros 60 nt
  )
}

# ğŸ§  Aplicar anÃ¡lisis a todos los virus
resultados <- lapply(virus_files, analizar_virus)

# ğŸ–¨ï¸ Imprimir resultados
for (nombre in names(resultados)) {
  secuencia_texto <- resultados[[nombre]]$complementaria  # Asignar la secuencia complementaria
  complementaria_texto <- resultados[[nombre]]$complementaria  # Asignar complementaria
  cat("\nğŸ”¬ Virus:", nombre, "\n")
  cat("ğŸ§¬ TamaÃ±o de la secuencia:", resultados[[nombre]]$tamano, "nucleÃ³tidos\n")
  cat("ğŸ§ª ComposiciÃ³n de nucleÃ³tidos (A, T, C, G):\n")
  print(resultados[[nombre]]$composicion)
  cat("ğŸ’¥ Contenido GC:", resultados[[nombre]]$GC, "%\n")
  # Mostrar los primeros 60 nucleÃ³tidos (como en el ejemplo de la guÃ­a)
  cat("ğŸ”¡ Secuencia original (primeros 60 nt):\n")
  cat(substr(secuencia_texto, 1, 60), "\n")
  cat("ğŸ§² Secuencia complementaria:\n")
  cat(complementaria_texto, "\n")
}

# ğŸ“Š Preparar datos para grÃ¡fica de composiciÃ³n
compo_df <- do.call(rbind, lapply(names(resultados), function(nombre) {
  data.frame(
    Virus = nombre,
    t(as.data.frame(resultados[[nombre]]$composicion[c("A", "T", "C", "G")]))
  )
}))

compo_melt <- melt(compo_df, id.vars = "Virus")

# ğŸ“ˆ GrÃ¡fico comparativo de nucleÃ³tidos
ggplot(compo_melt, aes(x = Virus, y = value, fill = variable)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "ComposiciÃ³n de nucleÃ³tidos por virus",
       y = "NÃºmero de nucleÃ³tidos", x = "Virus", fill = "NucleÃ³tido") +
  theme_minimal()

```

